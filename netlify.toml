# ==============================================================================
# 檔案路徑: netlify.toml
# 版本: v32.2 - 核心功能限定版
# ------------------------------------------------------------------------------
# 【此為完整檔案，可直接覆蓋】
# ==============================================================================

[build]
  command = "echo '無需建置指令'"
  publish = "test-shiporder"
  functions = "test-shiporder/netlify/functions"
  
  [build.environment]
    NODE_VERSION = "18"

# ==============================================================================
# [[redirects]] 區塊
# 我們回歸到最簡單、已經被驗證成功的模式，只處理核心功能。
# ==============================================================================

# 規則 1: 共用模組 (確保實體檔案被正確找到)
[[redirects]]
  from = "/_shared/*"
  to = "/_shared/:splat"
  status = 200

# 規則 2: 後台 SPA (只保留成功的 warehouse-panel，並指向其統一入口)
[[redirects]]
  from = "/warehouse-panel/*"
  to = "/warehouse-panel/index.html"
  status = 200

# 規則 3: 消費者前端 MPA (多頁應用)
# 這條規則會優先尋找實體檔案，這是解決購物車路由問題的關鍵
[[redirects]]
  from = "/GreenHealth-Auth-Module/*"
  to = "/GreenHealth-Auth-Module/:splat"
  status = 200

# 規則 4: 最後的「全收」規則
# 只在訪問根目錄或完全不存在的頂層路徑時，才導向消費者前端的首頁
[[redirects]]
  from = "/*"
  to = "/GreenHealth-Auth-Module/index.html"
  status = 200

# ==============================================================================
# ⚙️ 本地開發環境設定 (維持原樣)
# ==============================================================================
[dev]
  framework = "#static"
  publish = "."
  
# ==============================================================================
# 🔑 環境變數設定 (此處為範本，真實金鑰應在 Netlify UI 中設定)
# ==============================================================================
[context.production.environment]
  SUPABASE_URL = "https://your-project.supabase.co"
  SUPABASE_ANON_KEY = "your-anon-key"