# ==============================================================================
# 檔案路徑: netlify.toml
# 版本: v45.6 - 最小化增補版
# ------------------------------------------------------------------------------
# 【此為最終、唯一的路由設定檔，請刪除 _redirects 檔案】
# ==============================================================================

# --- 1. 基本建置設定 ---
# publish: 告訴 Netlify 您的網站檔案都放在 `test-shiporder` 這個資料夾裡。
# functions: 告訴 Netlify 您的後端雲端函式放在哪裡。
[build]
  command = "echo '無需建置指令'"
  publish = "test-shiporder"
  functions = "test-shiporder/netlify/functions"
  
  [build.environment]
    NODE_VERSION = "18"

# --- 2. 後端 Edge Functions 的 JWT 驗證白名單 ---
# 作用：告訴部署系統，以下列出的函式允許匿名使用者呼叫。
# 所有未在此處列出的函式，都將維持預設的安全設定（需要登入才能呼叫）。
[functions]
  [functions.get-or-create-cart]
    verify_jwt = false
  [functions.recalculate-cart]
    verify_jwt = false
  [functions.create-order-from-cart]
    verify_jwt = false
  [functions.validate-quantity]
    verify_jwt = false
  # 【核心增補】後台 Supabase Client 安全金鑰獲取
  # 理由: 這是後台應用程式初始化時，安全獲取 anon key 的端點，
  #       此階段使用者尚未登入，因此不能驗證 JWT。
  [functions.config]
    verify_jwt = false