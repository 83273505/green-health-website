# ==============================================================================
# Green Health Netlify 设定档 (最终繁中註解版)
# ==============================================================================

# [build]
# 全局设定。
# publish = "/" (我们暂时不设定全局 publish，让 Netlify 使用 UI 上的设定，通常是根目录 /)
[build]
  command = "echo '无需建置指令'"
  functions = "netlify/functions"

# ==============================================================================
# 🔁 重定向规则
# ==============================================================================
# 这个规则可能需要根据最终部署结构调整，暂时保留
[[redirects]]
  from = "/config.js"
  to = "/404.html"
  status = 404

# ==============================================================================
# 【✅ 新增部分】針對 test-shiporder 分支的重寫規則
# ==============================================================================
# 這個區塊將解決 warehouse-panel 404 的問題，並且不影響現有的消費者端功能。
# 規則:
# 1. 如果訪問的路徑以 /warehouse-panel/ 開頭，則直接從 test-shiporder/warehouse-panel/ 提供檔案。
# 2. 如果訪問的是其他路徑 (例如 /dashboard.html)，則從 test-shiporder/GreenHealth-Auth-Module/ 提供檔案。
# 3. status = 200 (重寫) 確保使用者的瀏覽器網址列不會改變。
[[redirects]]
  from = "/warehouse-panel/*"
  to = "/test-shiporder/warehouse-panel/:splat"
  status = 200
  conditions = { "branch" = ["test-shiporder"] } # 此規則只在 test-shiporder 分支生效

[[redirects]]
  from = "/*"
  to = "/test-shiporder/GreenHealth-Auth-Module/:splat"
  status = 200
  conditions = { "branch" = ["test-shiporder"] } # 此規則只在 test-shiporder 分支生效
  
# ==============================================================================
# ⚙️ 本地开发环境设定
# ==============================================================================
[dev]
  framework = "#static"
  publish = "."
  
# ==============================================================================
# 🔑 环境变数设定
# ==============================================================================
[context.production.environment]
  SUPABASE_URL = "https://your-project.supabase.co"
  SUPABASE_ANON_KEY = "your-anon-key"

# ==============================================================================
# 【核心设定】- 分支特定部署规则 (維持原樣，但新增的 redirects 規則優先級更高)
# ==============================================================================
# 🟢 test-shiporder 分支设定
[context."test-shiporder"]
  # 【注意】這裡的 publish 設定現在應該指向包含兩個模組的父目錄。
  # 由於 Netlify 的 redirects 規則是基於發布目錄的，
  # 我們需要將 publish 指向 '.' (專案根目錄)，這樣重寫規則才能正確找到
  # /test-shiporder/warehouse-panel/ 和 /test-shiporder/GreenHealth-Auth-Module/
  publish = "."

# 🟡 GreenHealth-Auth-Module 分支设定
[context."GreenHealth-Auth-Module"]
  # 这个分支的发布目录也是它自己。
  publish = "GreenHealth-Auth-Module"