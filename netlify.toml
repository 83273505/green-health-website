# ==============================================================================
# Green Health Netlify 设定档 (最终修正版)
# ==============================================================================

# [build]
# 全局建置設定
[build]
  command = "echo '无需建置指令'"
  # 【注意】這裡的 publish 設定為專案根目錄，這是讓重寫規則生效的前提
  publish = "." 
  functions = "netlify/functions" # Supabase functions 的路徑通常是這個

# ==============================================================================
# 🔁 重定向与重寫规则
# ==============================================================================

# 【核心修正】針對所有分支的通用重寫規則
# Netlify 會從上到下匹配規則

# 規則 1: 處理 /warehouse-panel/ 的請求
# 將所有 /warehouse-panel/ 開頭的請求，重寫到實際的 warehouse-panel 資料夾內
[[redirects]]
  from = "/warehouse-panel/*"
  to = "/warehouse-panel/:splat"
  status = 200 # 200 表示重寫

# 規則 2: 處理消費者前端的請求
# 將所有其他的請求，重寫到實際的 GreenHealth-Auth-Module 資料夾內
# 這條規則必須放在最後，作為一個「全收」規則
[[redirects]]
  from = "/*"
  to = "/GreenHealth-Auth-Module/:splat"
  status = 200

# ==============================================================================
# ⚙️ 本地开发环境设定
# ==============================================================================
[dev]
  framework = "#static"
  publish = "."
  
# ==============================================================================
# 🔑 环境变数设定 (維持不變)
# ==============================================================================
[context.production.environment]
  SUPABASE_URL = "https://your-project.supabase.co"
  SUPABASE_ANON_KEY = "your-anon-key"

# ==============================================================================
# 🔴【移除部分】- 不再需要分支特定的 publish 設定
# ==============================================================================
# 由於我們在全局的 [build] 中設定了 publish = "."，
# 並且重寫規則可以處理所有情況，因此不再需要為每個分支單獨設定 publish。
# 這讓設定更簡潔、更通用。